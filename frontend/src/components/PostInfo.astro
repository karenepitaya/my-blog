---
import { dateString } from '~/utils'
import type { PublicArticleListItem } from '~/lib/publicApi'

interface Props {
  article: PublicArticleListItem
  class?: string
}

const { article, class: className } = Astro.props

const authorUsername = article.author?.username ?? null
const category = article.category
const categoryHref =
  category && authorUsername
    ? `/categories/${encodeURIComponent(authorUsername)}/${encodeURIComponent(category.slug)}`
    : undefined
const publishedAt = article.publishedAt ? new Date(article.publishedAt) : null
---

<div class:list={[className, 'text-foreground/80']}>
  <div
    class="flex flex-col gap-4 sm:gap-2 sm:flex-wrap items-start sm:items-center sm:flex-row"
  >
    {
      category && categoryHref && (
        <a
          class="shrink-0 rounded-2xl py-[3px] px-3.5 bg-foreground/1 me-2.5 hover:bg-foreground/5 transition-colors border-1 border-foreground/16 hover:border-foreground/20"
          href={categoryHref}
        >
          {category.name}
        </a>
      )
    }
    {
      authorUsername && (
        <span class="shrink-0 rounded-2xl py-[3px] px-3.5 bg-accent/7 text-accent/90 hover:bg-accent/10 transition-colors border-1 border-accent/20 hover:border-accent/30 font-medium whitespace-nowrap">
          {authorUsername}
        </span>
      )
    }
    <div class="shrink-0 pl-0.5 text-[17px] sm:text-base">
      {publishedAt && <time>{dateString(publishedAt)}</time>}
    </div>
  </div>
</div>
